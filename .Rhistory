with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(stage0808~pop,data=data2016s_4)
Anova(m20)
m21<-lm(stage0808~pop+ori_new,data=data2016s_4)
Anova(m21)
anova(m20,m21)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new)
Anova(m22)
summary(m22)
with(data2016s_4, lineplot.CI(pred,stage0808,xlab="Predation",ylab="Max bud stage"))
m24<-lme(stage0808 ~ pred, data = data2016s_4, random = ~ 1|pop/ori_new)
Anova(m24)
with(data2016l_calc_4, lineplot.CI(pop,first_j))
with(data2016l_calc_4, bargraph.CI(pop,first_j,err.width=0.02,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, bargraph.CI(pop,last_j,err.width=0.02,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, bargraph.CI(pop,mean,err.width=0.02,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
warnings()
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
?axis.Date
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",xlab=NULL,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",xlab=NULL,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",xlab=NULL,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,las=2))
warnings()
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",
ylab="First flowering day",cex.axis=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",
ylab="Last flowering day",cex.axis=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",
ylab="Mean flowering day",cex.axis=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",xlab=NULL,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",xlab=NULL,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",xlab=NULL,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
m28<-lm(first_j~pop,data=data2016l_calc_4)
Anova(m28)
m29<-lm(first_j~pop+ori_new,data=data2016l_calc_4)
Anova(m29)
m30<-lme(first_j ~ pop, data = data2016l_calc_4, random = ~ 1|ori_new)
Anova(m30)
anova(m28,m29)#Only pop best
summary(m30)
Anova(m36) # pop significant!!!
Anova(m36) # pop significant!!!
Anova(m42) # pop significant!!!
with(data2016l_calc_4, lineplot.CI(pred,first_j))
with(data2016l_calc_4, lineplot.CI(pred,first_j))
m44<-lme(first_j ~ pred, data = data2016l_calc_4, random = ~ 1|pop/ori_new)
Anova(m44)
bargraph.CI(pop,phen,group=year,data=d1516,legend=T,err.width=0.02,
ylim=c(0,6),cex.names=0.8,cex.axis=0.8,ylab="Mean stage of most advanced bud",
main="Stage noted on 4-6 Aug 2015 and 8 Aug 2016",las=2)
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",xlab=NULL,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",xlab=NULL,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",xlab=NULL,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
m49<-lm(phen~year*pop,data=subset(d1516,!pop=="Bor012"&!pop=="Sve005"))
Anova(m49)
summary(m49)
summary(m49)
m49<-lm(phen~year*pop,data=subset(d1516,!pop=="Bor012"&!pop=="Sve005"))
Anova(m49)
m49<-lm(phen~year*pop,data=subset(d1516,!pop=="Bor012"&!pop=="Sve005"))
Anova(m49)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(stage0808~pop,data=data2016s_4)
Anova(m20)
m21<-lm(stage0808~pop+ori_new,data=data2016s_4)
Anova(m21)
anova(m20,m21)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new)
Anova(m22)
summary(m22)
with(data2016s_4, lineplot.CI(pred,stage0808,xlab="Predation",ylab="Max bud stage"))
m24<-lme(stage0808 ~ pred, data = data2016s_4, random = ~ 1|pop/ori_new)
Anova(m24)
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",xlab=NULL,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",xlab=NULL,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",xlab=NULL,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
m28<-lm(first_j~pop,data=data2016l_calc_4)
Anova(m28)
m29<-lm(first_j~pop+ori_new,data=data2016l_calc_4)
Anova(m29)
anova(m28,m29)
m30<-lme(first_j ~ pop, data = data2016l_calc_4, random = ~ 1|ori_new)
Anova(m30)
summary(m30)
m44<-lme(first_j ~ pred, data = data2016l_calc_4, random = ~ 1|pop/ori_new)
Anova(m44)
bargraph.CI(pop,phen,group=year,data=d1516,legend=T,err.width=0.02,
ylim=c(0,6),cex.names=0.8,cex.axis=0.8,ylab="Mean stage of most advanced bud",
main="Stage noted on 4-6 Aug 2015 and 8 Aug 2016",las=2)
m49<-lm(phen~year*pop,data=subset(d1516,!pop=="Bor012"&!pop=="Sve005"))
Anova(m49)
summary(m49)
data2015_4
data2015_4
getwd()
getwd()
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
getwd()
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
getwd()
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
View(data2015_4)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(stage0808~pop,data=data2016s_4)
Anova(m20)
m21<-lm(stage0808~pop+ori_new,data=data2016s_4)
Anova(m21)
anova(m20,m21)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new)
Anova(m22)
summary(m22)
with(data2016s_4, lineplot.CI(pred,stage0808,xlab="Predation",ylab="Max bud stage"))
m24<-lme(stage0808 ~ pred, data = data2016s_4, random = ~ 1|pop/ori_new)
Anova(m24)
with(data2016l_calc_4, lineplot.CI(pop,first_j,err.width=0.02,type="p",xlab=NULL,
ylab="First flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,last_j,err.width=0.02,type="p",xlab=NULL,
ylab="Last flowering day",cex.axis=0.8,cex.names=0.8,las=2))
with(data2016l_calc_4, lineplot.CI(pop,mean,err.width=0.02,type="p",xlab=NULL,
ylab="Mean flowering day",cex.axis=0.8,cex.names=0.8,las=2))
m28<-lm(first_j~pop,data=data2016l_calc_4)
Anova(m28)
m29<-lm(first_j~pop+ori_new,data=data2016l_calc_4)
Anova(m29)
anova(m28,m29)
m30<-lme(first_j ~ pop, data = data2016l_calc_4, random = ~ 1|ori_new)
Anova(m30)
summary(m30)
m44<-lme(first_j ~ pred, data = data2016l_calc_4, random = ~ 1|pop/ori_new)
Anova(m44)
bargraph.CI(pop,phen,group=year,data=d1516,legend=T,err.width=0.02,
ylim=c(0,6),cex.names=0.8,cex.axis=0.8,ylab="Mean stage of most advanced bud",
main="Stage noted on 4-6 Aug 2015 and 8 Aug 2016",las=2)
m49<-lm(phen~year*pop,data=subset(d1516,!pop=="Bor012"&!pop=="Sve005"))
Anova(m49)
summary(m49)
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
getwd()
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
setwd("D:/SU/Projects/local_adaptation")
getwd()
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
getwd()
getwd()
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
data2016s_4 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<4)),]
data2016s_4$pop<-droplevels(data2016s_4$pop)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(stage0808~pop,data=data2016s_4)
Anova(m20)
m20<-lm(stage0808~pop,data=data2016s_4)
Anova(m20)
str(data2016s_4)
m20<-lm(as.mumeric(stage0808)~pop,data=data2016s_4)
m20<-lm(as.numeric(stage0808)~pop,data=data2016s_4)
Anova(m20)
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
?as.numeri
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
data2016s_4 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<4)),]
data2016s_4$pop<-droplevels(data2016s_4$pop)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(as.numeric(stage0808)~pop,data=data2016s_4)
Anova(m20)
m21<-lm(stage0808~pop+ori_new,data=data2016s_4)
Anova(m21)
m21<-lm(as.integer(stage0808)~pop+ori_new,data=data2016s_4)
Anova(m21)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new)
m22<-lme(as.integer(stage0808) ~ pop, data = data2016s_4, random = ~ 1|ori_new)
data2016s_4$stage0808
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action = na.remove)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action ="na.remove"")
Anova(m22)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action ="na.rm"")
Anova(m22)
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action ="na.rm")
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action=na.rm)
?lme
m22<-lme(stage0808 ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action="na.exclude")
m22<-lme(as.integer(stage0808) ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action="na.exclude")
Anova(m22)
library(car)
library(lme4)
library(lmerTest)
library(sciplot)
library(nlme)
library(multcomp)
library(dplyr)
library(data.table)
data2015<-read.table("./data/clean/data2015_allfl.txt",header=T,sep="\t",dec=".")
data2015_4 <- data2015[!(as.numeric(data2015$pop) %in% which(table(data2015$pop)<4)),]
data2015_4$pop<-droplevels(data2015_4$pop)
unique(data2015_4[1:2])
with(data2015_4, bargraph.CI(pop,log(phen_index),err.width=0.02,ylab="Mean bud stage",cex.axis=0.8,cex.names=0.8,las=2))
with(data2015_4, bargraph.CI(pop,most_adv,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m4<-lm(log(phen_index)~pop,data=data2015_4)
Anova(m4)
m5<-lm(log(phen_index)~pop+ori_new,data=data2015_4)
Anova(m5)
anova(m4,m5)
m6<-lme(log(phen_index) ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m6)
m10<-lm(most_adv~pop,data=data2015_4)
Anova(m10)
m11<-lm(most_adv~pop+ori_new,data=data2015_4)
Anova(m11)
anova(m10,m11)
m12<-lme(most_adv ~ pop, data = data2015_4, random = ~ 1|ori_new)
Anova(m12)
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
data2016s_4 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<4)),]
data2016s_4$pop<-droplevels(data2016s_4$pop)
unique(data2016s_4[,c(2,20)])
with(data2016s_4, bargraph.CI(pop,stage0808,err.width=0.02,ylab="Max bud stage",cex.axis=0.8,cex.names=0.8,las=2))
m20<-lm(as.integer(stage0808)~pop,data=data2016s_4)
Anova(m20)
m21<-lm(as.integer(stage0808)~pop+ori_new,data=data2016s_4)
Anova(m21)
anova(m20,m21)
m22<-lme(as.integer(stage0808) ~ pop, data = data2016s_4, random = ~ 1|ori_new,na.action="na.exclude")
Anova(m22)
summary(m22)
with(data2016s_4, lineplot.CI(pred,stage0808,xlab="Predation",ylab="Max bud stage"))
?anova
table(data2015$pop)
table(data2015$pop,data2015$pred)
table(data2015_4$pop,data2015_4$pred)
table(data2016s_4$pop,data2016s_4$pred)
data2016s<-read.table("./data/clean/phen_cgarden_2016_clean_short.txt",header=T,sep="\t",dec=".")
head(data2016s)
tail(data2016s)
str(data2016s)
data2016s$ori_new<-as.factor(data2016s$ori_new)
data2016s$pred<-as.factor(data2016s$pred)
data2016s$stage0808<-as.integer(data2016s$stage0808)
data2016s<-data2016s[complete.cases(data2016s),]
with(data2016s,hist(stage0808))
data2016s_10 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<10)),]
data2016s_10$pop<-droplevels(data2016s_10$pop)
data2016s_5 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<5)),]
data2016s_5$pop<-droplevels(data2016s_5$pop)
data2016s_4 <- data2016s[!(as.numeric(data2016s$pop) %in% which(table(data2016s$pop)<4)),]
data2016s_4$pop<-droplevels(data2016s_4$pop)
table(data2016s_4$pop,data2016s_4$pred)
m22c <- glht(m22, linfct=mcp(pop="Tukey"))
summary(m22c)
m30c <- glht(m30, linfct=mcp(pop="Tukey"))
summary(m30c)
